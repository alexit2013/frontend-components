!function(e,t,o,i){function n(e,t){var i=this;i.$el=e,i.options=o.extend({},s,t),i.Base=o("<div class='vs-mask'></div>"),i.ContentHtml=o("<div class='vs-mask-box-content'></div>"),i.ContentHtml.html(i.options.html),i.ContentBox=o("<div class='vs-mask-box'></div>"),i.ContentBox.append(i.ContentHtml),o("body").append(i.Base),o("body").append(i.ContentBox)}var s={powerOff:!1,offTime:3e3,html:"加载中..."};n.prototype.init=function(e){this.options=o.extend({},this.defaults,e)},n.prototype.showMask=function(){(function(){var e=this.$el,i=this.Base,n=this.ContentBox;i.css("width",e.outerWidth(!0)+"px"),i.css("height",e.outerHeight(!0)+"px"),this.$el.html()!=o(t).html()&&e.html()!=o("body").html()&&(i.css("left",e.offset().left),i.css("top",e.offset().top)),n.css("width",e.outerWidth(!0)+"px"),n.css("height",e.outerHeight(!0)+"px"),this.$el.html()!=o(t).html()&&e.html()!=o("body").html()&&(n.css("left",e.offset().left),n.css("top",e.offset().top));var s=this.ContentHtml,a=parseInt((n.height()-s.height())/2);s.css("margin-top",a+"px")}).call(this),this.Base.show(),this.ContentBox.show()},n.prototype.closeMask=function(){(function(){}).call(this),this.ContentBox.hide(),this.Base.hide()};var a=o.fn.vsMask;o.fn.vsMask=function(e){var t=o.data(this[0],"vsMask");return t?t.init(e):o.data(this[0],"vsMask",t=new n(this,e)),t},o.fn.vsMask.constructor=n,o.fn.vsMask.noConflict=function(){return o.fn.vsMask=a,this}}(window,document,jQuery),function(e,t,o,i,n){var s=[],a=o(t),r=navigator.userAgent.toLowerCase(),l=o(e),c=[],d={ieQuirks:null,msie:/msie/.test(r)&&!/opera/.test(r),opera:/opera/.test(r)};d.ie6=d.msie&&/msie 6./.test(r)&&"object"!=typeof e.XMLHttpRequest,d.ie7=d.msie&&/msie 7.0/.test(r),d.boxModel="CSS1Compat"===t.compatMode;var h={appendTo:"body",focus:!0,opacity:50,overlayCss:{},containerCss:{},dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:!0,autoPosition:!0,zIndex:1e3,title:i.observable(""),titleHTML:'<span class="vs-simplemodal-modalTitle"></span>',close:!0,closeHTML:'<a class="vs-simplemodal-modalCloseImg"></a>',closeClass:"vs-simplemodal-close",escClose:!0,overlayClose:!0,fixed:!0,position:null,persist:!0,modal:!0,onOpen:null,onShow:null,onClose:null,onShut:null},u={d:{},init:function(e,t){var i=this;if(i.d.data)return i;if(d.ieQuirks=d.msie&&!d.boxModel,i.o=o.extend({},h,t),i.zIndex=i.o.zIndex,i.occb=!1,"object"==typeof e)e=e instanceof o?e:o(e),i.d.placeholder=!1,e.parent().parent().size()>0&&(e.before(o("<span></span>").attr("id","simplemodal-placeholder").css({display:"none"})),i.d.placeholder=!0,i.display=e.css("display"),i.o.persist||(i.d.orig=e.clone(!0)));else{if("string"!=typeof e&&"number"!=typeof e)return alert("SimpleModal Error: Unsupported data type: "+typeof e),i;e=o("<div></div>").html(e)}return i.create(e),e=null,i},create:function(e){var t=this;t.getDimensions(),t.o.modal&&d.ie6&&(t.d.iframe=o('<iframe src="javascript:false;"></iframe>').css(o.extend(t.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:c[0],width:c[1],zIndex:t.o.zIndex,top:0,left:0})).appendTo(t.o.appendTo)),t.d.overlay=o("<div></div>").addClass("vs-simplemodal-overlay").css(o.extend(t.o.overlayCss,{display:"none",opacity:t.o.opacity/100,height:t.o.modal?s[0]:0,width:t.o.modal?s[1]:0,position:"fixed",left:0,top:0,zIndex:t.o.zIndex+1})).appendTo(t.o.appendTo),t.d.container=o("<div></div>").addClass("vs-simplemodal-container").css(o.extend({position:t.o.fixed?"fixed":"absolute"},t.o.containerCss,{display:"none",zIndex:t.o.zIndex+2})),t.d.top=o("<div></div>").addClass("vs-simplemodal-top").appendTo(t.d.container),t.d.container.append(o(t.o.titleHTML).html(t.o.title())).appendTo(t.o.appendTo),t.d.container.append(t.o.close&&t.o.closeHTML?o(t.o.closeHTML).addClass(t.o.closeClass):"").appendTo(t.o.appendTo),t.d.wrap=o("<div></div>").attr("tabIndex",-1).addClass("vs-simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(t.d.container),t.d.data=e.addClass("vs-simplemodal-data").css(o.extend(t.o.dataCss,{display:"none"})).appendTo("body"),e=null,t.setContainerDimensions(),t.d.data.appendTo(t.d.wrap),(d.ie6||d.ieQuirks)&&t.fixIE()},bindEvents:function(){var e=this;o("."+e.o.closeClass).bind("click.simplemodal",function(t){t.preventDefault(),e.close()}),e.o.modal&&e.o.close&&e.o.overlayClose&&e.d.overlay.bind("click.simplemodal",function(t){t.preventDefault(),e.close()}),a.bind("keydown.simplemodal",function(t){e.o.modal&&9===t.keyCode?e.watchTab(t):e.o.close&&e.o.escClose&&27===t.keyCode&&(t.preventDefault(),e.close())}),l.bind("resize.simplemodal orientationchange.simplemodal",function(){e.getDimensions(),e.o.autoResize?e.setContainerDimensions():e.o.autoPosition&&e.setPosition(),d.ie6||d.ieQuirks?e.fixIE():e.o.modal&&(e.d.iframe&&e.d.iframe.css({height:c[0],width:c[1]}),e.d.overlay.css({height:s[0],width:s[1]}))});var t,i,n=!1;e.d.top.bind("mousedown.simplemodal",function(o){n=!0,t=o.pageX-parseInt(e.d.container.css("left")),i=o.pageY-parseInt(e.d.container.css("top"))}),a.bind("mousemove.simplemodal",function(o){if(n){var s=o.pageX-t,a=o.pageY-i;e.d.container.css({top:a,left:s})}}),a.bind("mouseup.simplemodal",function(e){n=!1})},unbindEvents:function(){o("."+this.o.closeClass).unbind("click.simplemodal"),a.unbind("keydown.simplemodal"),l.unbind(".simplemodal"),this.d.overlay.unbind("click.simplemodal"),a.unbind("mousemove.simplemodal"),a.unbind("mouseup.simplemodal"),this.d.top.unbind("mousedown.simplemodal")},fixIE:function(){var e=this.o.position;o.each([this.d.iframe||null,this.o.modal?this.d.overlay:null,"fixed"===this.d.container.css("position")?this.d.container:null],function(t,o){if(o){var i="document.body.clientHeight",n="document.body.clientWidth",s="document.body.scrollHeight",a="document.body.scrollLeft",r="document.body.scrollTop",l="document.body.scrollWidth",c="document.documentElement.clientHeight",d="document.documentElement.clientWidth",h="document.documentElement.scrollLeft",u="document.documentElement.scrollTop",p=o[0].style;if(p.position="absolute",t<2)p.removeExpression("height"),p.removeExpression("width"),p.setExpression("height",s+" > "+i+" ? "+s+" : "+i+' + "px"'),p.setExpression("width",l+" > "+n+" ? "+l+" : "+n+' + "px"');else{var f,g;if(e&&e.constructor===Array){var v=e[0]?"number"==typeof e[0]?e[0].toString():e[0].replace(/px/,""):o.css("top").replace(/px/,"");if(f=-1===v.indexOf("%")?v+" + (t = "+u+" ? "+u+" : "+r+') + "px"':parseInt(v.replace(/%/,""))+" * (("+c+" || "+i+") / 100) + (t = "+u+" ? "+u+" : "+r+') + "px"',e[1]){var m="number"==typeof e[1]?e[1].toString():e[1].replace(/px/,"");g=-1===m.indexOf("%")?m+" + (t = "+h+" ? "+h+" : "+a+') + "px"':parseInt(m.replace(/%/,""))+" * (("+d+" || "+n+") / 100) + (t = "+h+" ? "+h+" : "+a+') + "px"'}}else f="("+c+" || "+i+") / 2 - (this.offsetHeight / 2) + (t = "+u+" ? "+u+" : "+r+') + "px"',g="("+d+" || "+n+") / 2 - (this.offsetWidth / 2) + (t = "+h+" ? "+h+" : "+a+') + "px"';p.removeExpression("top"),p.removeExpression("left"),p.setExpression("top",f),p.setExpression("left",g)}}})},focus:function(e){var t=this,i=e&&-1!==o.inArray(e,["first","last"])?e:"first",n=o(":input:enabled:visible:"+i,t.d.wrap);setTimeout(function(){n.length>0?n.focus():t.d.wrap.focus()},10)},getDimensions:function(){var t=void 0===e.innerHeight?l.height():e.innerHeight;s=[a.height(),a.width()],c=[t,l.width()]},getVal:function(e,t){return e?"number"==typeof e?e:"auto"===e?0:e.indexOf("%")>0?parseInt(e.replace(/%/,""))/100*("h"===t?c[0]:c[1]):parseInt(e.replace(/px/,"")):null},update:function(e,t){if(!this.d.data)return!1;this.d.origHeight=this.getVal(e,"h"),this.d.origWidth=this.getVal(t,"w"),this.d.data.hide(),e&&this.d.container.css("height",e),t&&this.d.container.css("width",t),this.setContainerDimensions(),this.d.data.show(),this.o.focus&&this.focus(),this.unbindEvents(),this.bindEvents()},setContainerDimensions:function(){var e=d.ie6||d.ie7,t=this.d.origHeight?this.d.origHeight:d.opera?this.d.container.height():this.getVal(e?this.d.container[0].currentStyle.height:this.d.container.css("height"),"h"),o=this.d.origWidth?this.d.origWidth:d.opera?this.d.container.width():this.getVal(e?this.d.container[0].currentStyle.width:this.d.container.css("width"),"w"),i=this.d.data.outerHeight(!0),n=this.d.data.outerWidth(!0);this.d.origHeight=this.d.origHeight||t,this.d.origWidth=this.d.origWidth||o;var s=this.o.maxHeight?this.getVal(this.o.maxHeight,"h"):null,a=this.o.maxWidth?this.getVal(this.o.maxWidth,"w"):null,r=s&&s<c[0]?s:c[0],l=a&&a<c[1]?a:c[1],h=this.o.minHeight?this.getVal(this.o.minHeight,"h"):"auto";t=t?this.o.autoResize&&t>r?r:t<h?h:t:i?i>r?r:this.o.minHeight&&"auto"!==h&&i<h?h:i:h;var u=this.o.minWidth?this.getVal(this.o.minWidth,"w"):"auto";o=o?this.o.autoResize&&o>l?l:o<u?u:o:n?n>l?l:this.o.minWidth&&"auto"!==u&&n<u?u:n:u,this.d.container.css({height:this.o.autoResize?"auto":t,minHeight:t,width:o}),this.d.wrap.css({overflow:i>t||n>o?"auto":"visible"}),this.o.autoPosition&&this.setPosition()},setPosition:function(){var e,t,o=c[0]/2-this.d.container.outerHeight(!0)/2,i=c[1]/2-this.d.container.outerWidth(!0)/2,n="fixed"!==this.d.container.css("position")?l.scrollTop():0;this.o.position&&"[object Array]"===Object.prototype.toString.call(this.o.position)?(e=parseFloat(n)+parseFloat(this.o.position[0]||o),t=this.o.position[1]||i):(e=n+o,t=i),this.d.container.css({left:t,top:e})},watchTab:function(e){if(o(e.target).parents(".vs-simplemodal-container").length>0){if(this.inputs=o(":input:enabled:visible:first, :input:enabled:visible:last",this.d.data[0]),!e.shiftKey&&e.target===this.inputs[this.inputs.length-1]||e.shiftKey&&e.target===this.inputs[0]||0===this.inputs.length){e.preventDefault();var t=e.shiftKey?"last":"first";this.focus(t)}}else e.preventDefault(),this.focus()},open:function(){if(o.isFunction(this.o.onOpen)){if(!1===this.o.onOpen.apply(this,[this.d]))return}this.d.iframe&&this.d.iframe.show(),this.d.overlay.show(),this.d.container.show(),this.d.data.show(),this.o.focus&&this.focus(),this.bindEvents()},close:function(){if(!this.d.data)return this;if(this.unbindEvents(),o.isFunction(this.o.onClose)&&!this.occb&&(this.occb=!0,this.o.onClose.apply(this,[this.d])),this.d.placeholder){var e=o("#simplemodal-placeholder");this.o.persist?e.replaceWith(this.d.data.removeClass("vs-simplemodal-data").css("display",this.display)):(this.d.data.hide().remove(),e.replaceWith(this.d.orig))}else this.d.data.hide().remove();this.d.container.hide().remove(),this.d.overlay.hide(),this.d.iframe&&this.d.iframe.hide().remove(),this.d.overlay.remove(),this.d={},o.isFunction(this.o.onShut)&&this.o.onShut()}};i.vsWin={ViewModel:function(e){var t=this;t.opt=e,t.open=function(e){e&&e.title&&h.title(e.title);u.init(t.el,t.opt).open()},t.close=function(e){e&&e.title&&h.title(e.title);u.init(t.el,t.opt).close()}}},i.bindingHandlers.vsWin={init:function(e,t,o,i,n){return t().el=e,e.style.display="none",{controlsDescendantBindings:!1}},update:function(e,t,o,i,n){}}}(window,document,jQuery,ko),function(window,document,$,$ko,undefined){function setTitle(){this.mTitle[0]=lang.aWeekStr[0];for(var e=1;e<=7;e++){var t=this.options.firstDayOfWeek+e;t>7&&(t-=7),this.mTitle[e]=lang.aWeekStr[t]}0==this.options.isShowWeek&&this.mTitle.splice(0,1)}function setYearList(e){var t=this.curDate();e==undefined&&(e=t.getFullYear());var o=new Date(this.options.maxDate).getFullYear(),i=new Date(this.options.minDate).getFullYear();e<i&&(e=i),e>o&&(e=o);for(var n,s=10*parseInt(e/10),a=[],r=0;r<10;r++)r%2==0&&(n=[],a.push(n)),n.push({year:s+r,yearStr:s+r+"年",isValid:s+r>=i&&s+r<=o});this.mYear(a)}function setMonthList(){var e,t=[];for(var o in lang.aLongMonStr)o%2==0&&(e=[],t.push(e)),e.push({month:o,monthStr:lang.aLongMonStr[o]});this.mMonth(t)}function setDateList(){for(var e=this.curDate(),t=new Date(e.getFullYear(),e.getMonth(),1),o=t.getDay(),i=t.getMonth(),n=this.options.firstDayOfWeek-o,s=new Date(t.getTime()+(n>0?n-7:n)*duration.day),a=[],r=0;r<6;r++){var l=[],c={};if(1==this.options.isShowWeek){var d=new Date(s.getTime()+7*r*duration.day);c={isDate:!1,wk:getWeekByDate.call(this,d),css:this.options.css.wweek,cssOn:this.options.css.wweek},l.push(c)}for(j=0;j<7;j++){var h=new Date(s.getTime()+(7*r+j)*duration.day);(c={isDate:!0,year:h.getFullYear(),month:h.getMonth(),date:h.getDate(),weekday:h.getDay(),isToday:getDateIsToday.call(this,h),isValidDay:getDateIsValid.call(this,h),isWkd:0==h.getDay()||6==h.getDay(),isCurMonth:h.getMonth()==i,isCurDate:h.getFullYear()==e.getFullYear()&&h.getMonth()==e.getMonth()&&h.getDate()==e.getDate()}).isCurDate?(c.css=this.options.css.wselday,c.cssOn=this.options.css.wselday):0==c.isValidDay?(c.css=this.options.css.winvalidDay,c.cssOn=this.options.css.winvalidDay):0==c.isCurMonth?(c.css=this.options.css.wotherDay,c.cssOn=this.options.css.wotherDayOn):c.isToday?(c.css=this.options.css.wtoday,c.cssOn=this.options.css.wtoday):c.isWkd?(c.css=this.options.css.wwday,c.cssOn=this.options.css.wwdayOn):(c.css=this.options.css.wday,c.cssOn=this.options.css.wdayOn),l.push(c)}a.push({week:l})}this.mDate(a)}function setHourList(){var e,t=[];for(var o in lang.aLongHourStr)o%6==0&&(e=[],t.push(e)),e.push({hour:o,hourStr:lang.aLongHourStr[o]});this.mHour(t)}function setMinList(){var e,t=[],o=60/lang.aLongMinStr.length;for(var i in lang.aLongMinStr)i%6==0&&(e=[],t.push(e)),e.push({min:i*o,minStr:lang.aLongMinStr[i]});this.mMin(t)}function setSecList(){var e,t=[],o=60/lang.aLongSecStr.length;for(var i in lang.aLongSecStr)i%6==0&&(e=[],t.push(e)),e.push({sec:i*o,secStr:lang.aLongSecStr[i]});this.mSec(t)}function getWeekByDate(e){var t=duration.day,o=getFirstDateInYearWeek.call(this,e.getFullYear());e<o&&(o=getFirstDateInYearWeek.call(this,e.getFullYear()-1));var i=parseInt((e-o)/(7*t))+1;return i<10?"0"+i:i}function getYearWeekByDate(e){var t=duration.day,o=e.getFullYear(),i=getFirstDateInYearWeek.call(this,o);e<i&&(i=getFirstDateInYearWeek.call(this,o-=1));var n=parseInt((e-i)/(7*t))+1;return o.toString()+(n<10?"0"+n:n).toString()}function getFirstDateInYearWeek(e){duration.day;var t=new Date(e,0,1).getDay(),o=1;return t>this.options.firstDayOfWeek?o=this.options.firstDayOfWeek-t+7:t<this.options.firstDayOfWeek&&(o=t-this.options.firstDayOfWeek),new Date(e,0,o)}function getDateIsValid(e){var t=!1,o=new Date(this.options.maxDate),i=new Date(this.options.minDate);return e instanceof Date&&e>=i&&e<=o&&(t=!0),t}function getDateIsToday(e){var t=!1,o=new Date;return e instanceof Date&&e.getFullYear()==o.getFullYear()&&e.getMonth()==o.getMonth()&&e.getDate()==o.getDate()&&(t=!0),t}function date2str(date,fmt){if(date instanceof Date){var z={M:date.getMonth()+1,d:date.getDate(),H:date.getHours(),m:date.getMinutes(),s:date.getSeconds()};return(fmt=fmt.replace(/(M+|d+|H+|m+|s+)/g,function(v){return((v.length>1?"0":"")+eval("z."+v.slice(-1))).slice(-2)})).replace(/(y+)/g,function(e){return date.getFullYear().toString().slice(-e.length)})}return""}function strToDate(e){return e=e.replace(/-/g,"/"),new Date(e)}var lang={aWeekStr:["周","日","一","二","三","四","五","六"],aLongWeekStr:["周次","星期日","星期一","星期二","星期三","星期四","星期五","星期六"],aMonStr:["一","二","三","四","五","六","七","八","九","十","十一","十二"],aLongMonStr:["01月","02月","03月","04月","05月","06月","07月","08月","09月","10月","11月","12月"],aHourStr:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],aLongHourStr:["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],aMinStr:["0","5","10","15","20","25","30","35","40","45","50","55"],aLongMinStr:["00","05","10","15","20","25","30","35","40","45","50","55"],aSecStr:["0","10","20","30","40","50"],aLongSecStr:["00","10","20","30","40","50"]},duration={sec:1e3,min:6e4,hour:144e4,day:864e5},defaults={dateFmt:"yyyy-MM-dd",minDate:"1900/01/01 00:00:00",maxDate:"2099/12/31 23:59:59",firstDayOfWeek:0,isShowWeek:!1,isShowDate:!0,isShowTime:!1,isEditHour:!0,isEditMin:!0,isEditSec:!0,initDate:"",css:{wday:"vs-calendar-Wday",wdayOn:"vs-calendar-WdayOn",wwday:"vs-calendar-Wwday",wwdayOn:"vs-calendar-WwdayOn",wtoday:"vs-calendar-Wtoday",wselday:"vs-calendar-Wselday",wspecialDay:"vs-calendar-WspecialDay",wotherDay:"vs-calendar-WotherDay",wotherDayOn:"vs-calendar-WotherDayOn",winvalidDay:"vs-calendar-WinvalidDay",wweek:"vs-calendar-Wweek"},zIndex:9999,selectFn:null};$ko.vsCalendar={ViewModel:function(e){var t=this;t.options=$.extend(!0,{},defaults,e),t.curDate=$ko.observable(""),t.mTitle=[],t.mYear=$ko.observableArray([]),t.mMonth=$ko.observableArray([]),t.mDate=$ko.observableArray([]),t.mHour=$ko.observableArray([]),t.mMin=$ko.observableArray([]),t.mSec=$ko.observableArray([]),t.selTimeType="h",t.getSelectDate=$ko.observable(""),t.getSelectWeek=$ko.computed(function(){var e=$ko.unwrap(t.getSelectDate);return""==e?"":getYearWeekByDate.call(t,e)},t),t.getSelectDateStr=$ko.computed(function(){return date2str($ko.unwrap(t.getSelectDate),t.options.dateFmt)},t);var o=t.options.initDate,i=new Date;""!=o&&(i=strToDate(o)),t.setCurDate(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds()),""!=o&&t.getSelectDate(t.curDate()),setTitle.call(t)}},$ko.vsCalendar.ViewModel.prototype.show=function(e){var t=this,o=t.getSelectDate();""!=o&&t.setCurDate(o.getFullYear(),o.getMonth(),o.getDate(),o.getHours(),o.getMinutes(),o.getSeconds());var i=$.event.fix(e||window.event);if(i.target){var n=i.target,s=$(n),a=s.offset();$(t.el).css({left:a.left+"px",top:a.top+s.outerHeight()+"px",position:"absolute","z-index":t.options.zIndex}).slideDown("fast");var r=function(e){n==e.target||e.target.id==t.el.id||$(e.target).parents("#"+t.el.id).length>0||($(t.el).fadeOut("fast"),$("body").unbind("click.vsCalendar",r))};$("body").bind("click.vsCalendar",r)}},$ko.vsCalendar.ViewModel.prototype.close=function(){$(this.el).fadeOut("fast")},$ko.vsCalendar.ViewModel.prototype.confirm=function(){var e=this.curDate();this.getSelectDate(e),this.close()},$ko.vsCalendar.ViewModel.prototype.clear=function(){this.getSelectDate(""),this.close()},$ko.vsCalendar.ViewModel.prototype.reset=function(e){this.getSelectDate(""),null!=e&&(this.options=$.extend(!0,{},defaults,this.options,e));var t=this.options.initDate,o=new Date;""!=t&&(o=strToDate(t)),this.setCurDate(o.getFullYear(),o.getMonth(),o.getDate(),o.getHours(),o.getMinutes(),o.getSeconds()),""!=t&&this.getSelectDate(this.curDate()),this.selTimeType="h",setTitle.call(this)},$ko.vsCalendar.ViewModel.prototype.selectDate=function(e){var t=strToDate(e);this.setCurDate(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds()),this.getSelectDate(this.curDate())},$ko.vsCalendar.ViewModel.prototype.setCurDate=function(e,t,o,i,n,s){var a=this.curDate();e==undefined&&(e=a.getFullYear()),t==undefined&&(t=a.getMonth()),o==undefined&&(o=a.getDate());var r=new Date(e,t+1,0).getDate();i==undefined&&(i=a.getHours()),n==undefined&&(n=a.getMinutes()),s==undefined&&(s=a.getSeconds()),o=r>o?o:r,i=i>23?0:i<0?23:i,n=n>59?0:n<0?59:n,s=s>59?0:s<0?59:s;var l=new Date(e,t,o,i,n,s),c=new Date(this.options.maxDate),d=new Date(this.options.minDate);l>c?l=c:l<d&&(l=d),e=l.getFullYear(),t=l.getMonth(),o=l.getDate(),i=l.getHours(),n=l.getMinutes(),s=l.getSeconds(),0==this.options.isEditHour&&(i=0),0==this.options.isEditMin&&(n=0),0==this.options.isEditSec&&(s=0),l=new Date(e,t,o,i,n,s),this.curDate(l),setDateList.call(this)},$ko.vsCalendar.ViewModel.prototype.setYear=function(e){var t=this.curDate();this.setCurDate(e,t.getMonth())},$ko.vsCalendar.ViewModel.prototype.setMonth=function(e){var t=this.curDate();this.setCurDate(t.getFullYear(),e)},$ko.vsCalendar.ViewModel.prototype.setDate=function(e,t,o){var i=this.curDate();this.setCurDate(e,t,o),i.getFullYear()!=e||i.getMonth()!=t||i.getDate()!=o||this.confirm()},$ko.vsCalendar.ViewModel.prototype.setHour=function(e){var t=this.curDate();this.setCurDate(t.getFullYear(),t.getMonth(),t.getDate(),e)},$ko.vsCalendar.ViewModel.prototype.setMin=function(e){var t=this.curDate();this.setCurDate(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),e,t.getSeconds())},$ko.vsCalendar.ViewModel.prototype.setSec=function(e){var t=this.curDate();this.setCurDate(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),e)},$ko.vsCalendar.ViewModel.prototype.setToday=function(){var e=new Date;this.setCurDate(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds())},$ko.vsCalendar.ViewModel.prototype.setPrevTime=function(){var e=this.curDate();switch(this.selTimeType){case"m":1==this.options.isEditMin&&this.setCurDate(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes()-1,e.getSeconds());break;case"s":1==this.options.isEditSec&&this.setCurDate(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()-1);break;case"h":default:1==this.options.isEditHour&&this.setCurDate(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours()-1,e.getMinutes(),e.getSeconds())}},$ko.vsCalendar.ViewModel.prototype.setPrevMonth=function(){var e=this.curDate();this.setCurDate(e.getFullYear(),e.getMonth()-1)},$ko.vsCalendar.ViewModel.prototype.setPrevYear=function(){var e=this.curDate();this.setCurDate(e.getFullYear(),e.getMonth()-12)},$ko.vsCalendar.ViewModel.prototype.setNextTime=function(){var e=this.curDate();switch(this.selTimeType){case"m":1==this.options.isEditMin&&this.setCurDate(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes()+1,e.getSeconds());break;case"s":1==this.options.isEditSec&&this.setCurDate(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()+1);break;case"h":default:1==this.options.isEditHour&&this.setCurDate(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours()+1,e.getMinutes(),e.getSeconds())}},$ko.vsCalendar.ViewModel.prototype.setNextMonth=function(){var e=this.curDate();this.setCurDate(e.getFullYear(),e.getMonth()+1)},$ko.vsCalendar.ViewModel.prototype.setNextYear=function(){var e=this.curDate();this.setCurDate(e.getFullYear(),e.getMonth()+12)},$ko.vsCalendar.ViewModel.prototype.getCurYearStr=function(){return this.curDate().getFullYear()+"年"},$ko.vsCalendar.ViewModel.prototype.getCurMonthStr=function(){var e=this.curDate().getMonth();return lang.aLongMonStr[e]},$ko.vsCalendar.ViewModel.prototype.getCurHourStr=function(){var e=this.curDate().getHours();return lang.aLongHourStr[e]},$ko.vsCalendar.ViewModel.prototype.getCurMinStr=function(){var e=this.curDate().getMinutes();return e>=0&&e<10&&(e="0"+e),e},$ko.vsCalendar.ViewModel.prototype.getCurSecStr=function(){var e=this.curDate().getSeconds();return e>=0&&e<10&&(e="0"+e),e},$ko.vsCalendar.ViewModel.prototype.showYearList=function(e,t,o){var i=$(this.el);setYearList.call(this,o);var n=$(".vs-calendar-YMenu",i);n.show();var s=$.event.fix(t||window.event);if(s.target){var a=s.target,r=function(e){a!=e.target&&(n.hide(),$("body").unbind("click.vsCalendar",r))};$("body").bind("click.vsCalendar",r)}},$ko.vsCalendar.ViewModel.prototype.showMonthList=function(e,t){var o=$(this.el);setMonthList.call(this);var i=$(".vs-calendar-MMenu",o);i.show();var n=$.event.fix(t||window.event);if(n.target){var s=n.target,a=function(e){s!=e.target&&(i.hide(),$("body").unbind("click.vsCalendar",a))};$("body").bind("click.vsCalendar",a)}},$ko.vsCalendar.ViewModel.prototype.showHourList=function(e,t){if(this.selTimeType="h",0!=this.options.isEditHour){var o=$(this.el);setHourList.call(this);var i=$(".vs-calendar-HHMenu",o);i.show();var n=$.event.fix(t||window.event);if(n.target){var s=n.target,a=function(e){s!=e.target&&(i.hide(),$("body").unbind("click.vsCalendar",a))};$("body").bind("click.vsCalendar",a)}}},$ko.vsCalendar.ViewModel.prototype.showMinList=function(e,t){if(this.selTimeType="m",0!=this.options.isEditMin){var o=$(this.el);setMinList.call(this);var i=$(".vs-calendar-MMMenu",o);i.show();var n=$.event.fix(t||window.event);if(n.target){var s=n.target,a=function(e){s!=e.target&&(i.hide(),$("body").unbind("click.vsCalendar",a))};$("body").bind("click.vsCalendar",a)}}},$ko.vsCalendar.ViewModel.prototype.showSecList=function(e,t){if(this.selTimeType="s",0!=this.options.isEditSec){var o=$(this.el);setSecList.call(this);var i=$(".vs-calendar-SSMenu",o);i.show();var n=$.event.fix(t||window.event);if(n.target){var s=n.target,a=function(e){s!=e.target&&(i.hide(),$("body").unbind("click.vsCalendar",a))};$("body").bind("click.vsCalendar",a)}}},$ko.bindingHandlers.vsCalendar={init:function(e,t,o,i,n){var s=t();for(s.el=e,e.style.display="none";e.firstChild;)$ko.removeNode(e.firstChild);var a=o.get("calendarTemplate"),r=e.appendChild(document.createElement("DIV"));return $ko.renderTemplate(a,s,{},r,"replaceNode"),{controlsDescendantBindings:!0}},update:function(e,t,o,i,n){}}}(window,document,jQuery,ko),function(e,t,o,i,n){function s(e,t){var o=i.unwrap(this.maxPageIndex),n=i.unwrap(this.pageSize);if(e>o&&(e=o),e<1&&(e=1),0==t){if(e==i.unwrap(this.currentPageIndex))return}this.options.pageChanged&&this.options.pageChanged(e,n)}var a={pageSize:20,pages:[10,20,50,100],pageChanged:null};i.vsPage={ViewModel:function(e){var t=this;t.options=o.extend(!0,{},a,e),t.totalCount=i.observable(0),t.pageSize=i.observable(t.options.pageSize),t.pages=i.observableArray(t.options.pages),t.currentPageIndex=i.observable(1),t.jumpPage=i.observable(""),t.maxPageIndex=i.computed(function(){return Math.ceil(i.unwrap(t.totalCount)/i.unwrap(t.pageSize))},t),t.canPrev=i.computed(function(){return i.unwrap(t.currentPageIndex)>1},t),t.canNext=i.computed(function(){return i.unwrap(t.currentPageIndex)<i.unwrap(t.maxPageIndex)},t),t.goFirst=function(){s.call(t,1,!1)},t.goPrev=function(){var e=parseInt(i.unwrap(t.currentPageIndex),10)-1;s.call(t,e,!1)},t.goLast=function(){var e=i.unwrap(t.maxPageIndex);s.call(t,e,!1)},t.goNext=function(){var e=parseInt(i.unwrap(t.currentPageIndex),10)+1;s.call(t,e,!1)},t.jump=function(){var e=i.unwrap(t.jumpPage),o=i.unwrap(t.maxPageIndex);/^[0-9]*[1-9][0-9]*$/.test(e)?(e<1?e=1:e>o&&(e=o),s.call(t,e,!1)):alert("请输入数字"),t.jumpPage("")},t.pageSizeChanged=function(){s.call(t,1,!0)}}},i.bindingHandlers.vsPage={init:function(e,o,n,s,a){var r=o();for(r.el=e;e.firstChild;)i.removeNode(e.firstChild);var l=n.get("pageTemplate"),c=e.appendChild(t.createElement("DIV"));return i.renderTemplate(l,r,{},c,"replaceNode"),{controlsDescendantBindings:!0}},update:function(e,t,o,i,n){}}}(window,document,jQuery,ko),function(e,t,o,i,n){function s(e,t,n){var s=this,a={success:!1,message:"数据加载失败",list:[],total:0};s.checkItems([]),o("input[type='checkbox']",s.el).prop("checked",!1),o("input[type='radio']",s.el).prop("checked",!1);var r=i.toJSON({model:n,pageIndex:e,pageSize:t});o.ajax({url:s.options.url,type:s.options.type,contentType:"application/json",data:"get"==s.options.type?o.parseJSON(r):r,dataType:"json",beforeSend:function(){(function(){o(this.el).vsMask().showMask()}).call(s)},complete:function(){if(function(){o(this.el).vsMask().closeMask()}.call(s),s.data.removeAll(),0==a.success)alert(a.message);else if(null!=a.list)for(var t=0;t<a.list.length;t++)s.data.push(a.list[t]);0==a.total&&(e=1),s.totalCount(a.total),s.currentPageIndex(e),null!=s.options.completeFn&&s.options.completeFn(a)},success:function(e){a=e}})}var a={url:"",type:"post",joinChar:",",idKey:"id",frozen_headers:[[]],frozen_columns:[],headers:[[]],columns:[],rowOpts:[],rowStyle:"bg",alternatingRowStyle:"alterbg",selectRowStyle:"selectbg",isInitLoad:!0,query:{},completeFn:null,pageSize:20,pages:[10,20,50,100]},r={title:"",align:"center",rowspan:1,colspan:1,width:"auto",checkbox:!1,formatter:null},l={field:"",align:"left",width:"auto",checkbox:!1,radio:!1,options:[],formatter:null};i.vsGrid={ViewModel:function(e){var t=this;t.options=o.extend(!0,{},a,e),i.vsPage.ViewModel.call(t,t.options);var n,c;for(n=0;n<t.options.headers.length;n++)for(c=0;c<t.options.headers[n].length;c++)t.options.headers[n][c]=o.extend(!0,{},r,t.options.headers[n][c]);for(n=0;n<t.options.frozen_headers.length;n++)for(c=0;c<t.options.frozen_headers[n].length;c++)t.options.frozen_headers[n][c]=o.extend(!0,{},r,t.options.frozen_headers[n][c]);for(n=0;n<t.options.columns.length;n++)t.options.columns[n]=o.extend({},l,t.options.columns[n]);for(n=0;n<t.options.frozen_columns.length;n++)t.options.frozen_columns[n]=o.extend({},l,t.options.frozen_columns[n]);t.data=i.observableArray([]),t.checkItems=i.observable([]),t.query=i.observable(t.options.query),t.options.pageChanged=function(e,o){s.call(t,e,o,t.query())}}},i.vsGrid.ViewModel.prototype.reload=function(e){this.options=o.extend(!0,{},this.options,e),this.pageSizeChanged()},i.vsGrid.ViewModel.prototype.getRowStyle=function(e,t){for(var o=e.rowIndex%2==1?this.options.rowStyle:this.options.alternatingRowStyle,i=this.checkItems(),n=this.options.idKey,s=0;s<i.length;s++)i[s]==t[n]&&(o=this.options.selectRowStyle);return o},i.vsGrid.ViewModel.prototype.checkAll=function(e){var t=o(e).prop("checked"),i=[];o("input[name='"+e.name+"']",this.el).each(function(){var e=o(this);1==t&&""!=e.val()&&i.push(e.val()),e.prop("checked",t)}),this.checkItems(i)},i.vsGrid.ViewModel.prototype.check=function(e){var t=[];o("input[name='"+e.name+"']",this.el).each(function(){var e=o(this);1==e.prop("checked")&&""!=e.val()&&t.push(e.val())}),this.checkItems(t)},i.vsGrid.ViewModel.prototype.getCheckedData=function(e){var t=this.checkItems();return void 0==e&&(e=this.options.joinChar),t.join(e)},i.vsGrid.ViewModel.prototype.getCheckedRow=function(){for(var e=this.checkItems(),t=this.data(),o=this.options.idKey,i=[],n=0;n<t.length;n++)for(j=0;j<e.length;j++)if(e[j]==t[n][o]){i.push(t[n]);break}return i},i.bindingHandlers.vsGrid={init:function(e,o,n,s,a){var r=o();for(r.el=e;e.firstChild;)i.removeNode(e.firstChild);var l=n.get("gridTemplate"),c=n.get("pageTemplate"),d=e.appendChild(t.createElement("DIV"));if(i.renderTemplate(l,r,{},d,"replaceNode"),null!=c){var h=e.appendChild(t.createElement("DIV"));i.renderTemplate(c,r,{},h,"replaceNode")}return 1==r.options.isInitLoad&&r.reload.call(r),{controlsDescendantBindings:!0}},update:function(e,t,o,i,n){}}}(window,document,jQuery,ko),function(e,t,o,i,n){var s={width:"auto",url:"",searchKey:"name",selectKey:"name",loaderFn:null,confirmFn:null,renderFn:null,selectFn:null,pageSize:10,pagination:!0,"z-index":1e4},a=38,r=40,l=13;i.vsAutoComplete={ViewModel:function(e){var t=this;t.options=o.extend(!0,{},s,e),i.vsPage.ViewModel.call(t,t.options),t.keySelect=i.observable(-1),t.searchValue=i.observable(""),t.selectItem=i.observable(),t.sourceData=i.observableArray([]),t.options.pageChanged=function(e,n){(function(e,t){var n=this,s={success:!1,message:"数据加载失败",list:[],total:0},a={model:{},pageIndex:e,pageSize:t},r=n.options.searchKey,l=n.searchValue();a.model[r]=l,null!=n.options.loaderFn&&(a=n.options.loaderFn(a)),o.ajax({url:n.options.url,type:"post",contentType:"application/json",dataType:"json",data:i.toJSON(a),complete:function(){if(n.sourceData.removeAll(),0==s.success)alert(s.message);else if(null!=s.list)for(var t=0;t<s.list.length;t++)n.sourceData.push(s.list[t]);0==s.total&&(e=1),n.totalCount(s.total),n.currentPageIndex(e)},success:function(e){s=e}})}).call(t,e,n)},t.searchValue.subscribe(function(e){e=o.trim(e),t.keySelect(-1),e.length<=0?t.sourceData([]):t.pageSizeChanged(),null!=t.options.selectFn&&t.options.selectFn()})}},i.vsAutoComplete.ViewModel.prototype.show=function(t){var i=this,n=o.event.fix(t||e.event);if(n.target){i.keySelect(-1);var s=n.target,a=o(s),r=a.offset();o(i.el).css({left:r.left+"px",top:r.top+a.outerHeight()+"px",position:"absolute","z-index":i.options["z-index"]}).slideDown("fast");var l=function(e){s==e.target||e.target.id==i.el.id||o(e.target).parents("#"+i.el.id).length>0||(i.close(),o("body").unbind("click.vsAutoComplete",l))};o("body").bind("click.vsAutoComplete",l)}},i.vsAutoComplete.ViewModel.prototype.keypress=function(t){var i=o.event.fix(t||e.event),n=this.keySelect(),s=this.sourceData().length;switch(i.keyCode){case a:--n<0&&(n=s-1);break;case r:++n>=s&&(n=0);break;case l:t.target.blur(),this.confirm(this.sourceData()[n])}this.keySelect(n)},i.vsAutoComplete.ViewModel.prototype.close=function(){o(this.el).fadeOut("fast")},i.vsAutoComplete.ViewModel.prototype.confirm=function(e){var t=this.options.selectKey;this.keySelect(-1),this.searchValue(e[t]),this.selectItem(e),this.close(),this.options.confirmFn&&this.options.confirmFn()},i.vsAutoComplete.ViewModel.prototype.render=function(e){return null==this.options.renderFn?e[this.options.selectKey]:this.options.renderFn(e)},i.vsAutoComplete.ViewModel.prototype.clear=function(){this.sourceData([]),this.keySelect(-1),this.searchValue(""),this.selectItem(null),this.currentPageIndex(1),this.close()},i.bindingHandlers.vsAutoComplete={init:function(e,o,n,s,a){var r=o();for(r.el=e;e.firstChild;)i.removeNode(e.firstChild);var l=n.get("autoCompleteTemplate"),c=e.appendChild(t.createElement("DIV"));return i.renderTemplate(l,r,{},c,"replaceNode"),{controlsDescendantBindings:!0}},update:function(e,t,o,i,n){}}}(window,document,jQuery,ko),function(e,t,o,i,n){function s(){var e=this,t=o.extend(!0,{},{callback:{onClick:function(e,t,o,i){},onCheck:function(t,o,i){var n=e.ztree.getCheckedNodes(!0);e.sourceData(n),e.options.selectFn&&e.options.selectFn()},beforeAsync:function(t,o){return 1!=e.isLoadingTree()&&(e.isLoadingTree(!0),!0)},onAsyncSuccess:function(t,o,i,n){e.isLoadingTree(!1),e.canShow(!0),a.call(e)},onAsyncError:function(t,o,i,n,s,a){e.isLoadingTree(!1),e.canShow(!0)}}},e.options.ztree_setting);return null==e.options.data?o.fn.zTree.init(o("#"+e.treeId),t):(e.canShow(!0),o.fn.zTree.init(o("#"+e.treeId),t,e.options.data))}function a(){var e=this.options.ztree_setting.data.simpleData.idKey,t=this.options.memberIdValues;for(var o in t){var i=this.ztree.getNodeByParam(e,t[o]);i&&this.ztree.checkNode(i,!0,!1)}var n=this.ztree.getCheckedNodes(!0);this.sourceData(n)}var r={memberIdValues:[],selectKey:"name",joinChar:",",confirmFn:null,selectFn:null,data:null,ztree_setting:{check:{enable:!0,chkboxType:{Y:"",N:""},chkStyle:"checkbox",radioType:"all"},async:{url:"",enable:!0,type:"post",contentType:"application/json",dataType:"json",cache:!1},data:{key:{name:"name",checked:"isChecked"},simpleData:{enable:!0,idKey:"id",pIdKey:"parentId",rootPId:null}}}};i.vsTreeSelector={ViewModel:function(e){var t=this;t.options=o.extend(!0,{},r,e),t.ztree=null,t.sourceData=i.observableArray([]),t.canShow=i.observable(!1),t.isLoadingTree=i.observable(!1),t.getSelectDataStr=i.computed(function(){return t.getSelectData(t.options.selectKey)},t)}},i.vsTreeSelector.ViewModel.prototype.show=function(t){var i=this;if(0!=i.canShow()){if(i.ztree){0==i.ztree.getNodes().length&&i.ztree.reAsyncChildNodes(null,"refresh")}else i.ztree=s.call(i);var n=o.event.fix(t||e.event);if(n.target){var a=n.target,r=o(a),l=r.offset();o(i.el).css({left:l.left+"px",top:l.top+r.outerHeight()+"px","z-index":1e4,position:"absolute"}).slideDown("fast");var c=function(e){a==e.target||e.target.id==i.el.id||o(e.target).parents("#"+i.el.id).length>0||(i.close(),o("body").unbind("click.vsTreeSelector",c))};o("body").bind("click.vsTreeSelector",c)}}},i.vsTreeSelector.ViewModel.prototype.close=function(){o(this.el).fadeOut("fast"),this.options.confirmFn&&this.options.confirmFn()},i.vsTreeSelector.ViewModel.prototype.getSelectData=function(e,t){var o=this.sourceData();if("string"==typeof e&&void 0!=o){var i=[];for(var n in o)i.push(o[n][e]);return"array"==t?i:(void 0==t&&(t=this.options.joinChar),i.join(t))}return o},i.vsTreeSelector.ViewModel.prototype.reload=function(e,t){if(e&&(this.options.memberIdValues=[],this.options=o.extend(!0,{},r,this.options,e)),this.sourceData([]),this.ztree){this.ztree.checkAllNodes(!1);var i=this.ztree.getCheckedNodes(!0);if(i.length>0)for(var n=0;n<i.length;n++)this.ztree.checkNode(i[n],!1,!1);this.ztree.cancelSelectedNode(),this.ztree.expandAll(!1),void 0!=t&&1==t?this.ztree.reAsyncChildNodes(null,"refresh"):this.options.memberIdValues.length>0&&a.call(this)}else this.ztree=s.call(this),this.options.memberIdValues.length>0&&a.call(this)},i.bindingHandlers.vsTreeSelector={init:function(e,o,n,a,r){var l=o();for(l.el=e,l.treeId=e.id+"_tree",e.style.display="none";e.firstChild;)i.removeNode(e.firstChild);var c=n.get("treeSelectorTemplate"),d=e.appendChild(t.createElement("DIV"));return i.renderTemplate(c,l,{},d,"replaceNode"),l.ztree=s.call(l),{controlsDescendantBindings:!0}},update:function(e,t,o,i,n){}}}(window,document,jQuery,ko),function(e,t,o,i,n){function s(){var e=this.rawSourceData();0==e.length&&function(){var e=this;o.ajax({url:e.options.memberUrl,type:"post",contentType:"application/json",data:JSON.stringify(e.options.memberQuery),dataType:"json",success:function(t){e.rawSourceData(t.list),e.sourceData(t.list)},error:function(){alert("数据加载失败")}})}.call(this),e=this.rawSourceData();var t=this.searchValue(),i=[];if(""==t)i=e;else for(var n=this.options.memberSearchKey,s=0;s<e.length;s++)for(var a=0;a<n.length;a++)if(e[s][n[a]].indexOf(t)>=0){i.push(e[s]);break}this.sourceData(i)}function a(){var e=this.options.memberIdValues;if(this.rawTargetData([]),this.targetData([]),0!=e.length){for(var t=this.options.memberIdKey,i=this.rawSourceData(),n=[],s=0;s<i.length;s++)o.inArray(i[s][t],e)>=0&&n.push(i[s]);this.rawTargetData(n),this.targetData(n)}}var r={memberUrl:"",memberIdKey:"id",memberNameKey:"name",memberIdValues:[],memberSearchKey:["name"],memberQuery:{},joinChar:",",vsWin_setting:{persist:!0}};i.vsMemberSelector={ViewModel:function(e){var t=this;t.options=o.extend(!0,{},r,e),t.vsWin=null,t.searchValue=i.observable(""),t.rawSourceData=i.observableArray([]),t.rawTargetData=i.observableArray([]),t.sourceData=i.observableArray([]),t.targetData=i.observableArray([]),t.selectSource=i.observableArray([]),t.selectTarget=i.observableArray([]),t.searchValue.subscribe(function(e){s.call(t)}),s.call(t),a.call(t)}},i.vsMemberSelector.ViewModel.prototype.show=function(){var e=this.rawTargetData();this.targetData(e),s.call(this),this.vsWin?this.vsWin.open():o(this.el).show()},i.vsMemberSelector.ViewModel.prototype.close=function(){this.vsWin?this.vsWin.close():o(this.el).hide()},i.vsMemberSelector.ViewModel.prototype.confirm=function(){this.vsWin?this.vsWin.close():o(this.el).hide();var e=this.targetData();this.rawTargetData(e)},i.vsMemberSelector.ViewModel.prototype.getSelectData=function(e,t){var o=this.rawTargetData();if("string"==typeof e&&void 0!=o){var i=[];for(var n in o)i.push(o[n][e]);return"array"==t?i:(void 0==t&&(t=this.options.joinChar),i.join(t))}return o},i.vsMemberSelector.ViewModel.prototype.move=function(){var e=this.options.memberIdKey,t=this.selectSource(),i=this.sourceData(),n=this.targetData(),s=o.grep(i,function(o,i){for(var n=0;n<t.length;n++)if(o[e]==t[n])return!1;return!0});this.sourceData(s);var a=o.grep(i,function(o,i){for(var n=0;n<t.length;n++)if(o[e]==t[n])return!1;return!0},!0),r=[];o.each(a,function(t,i){var s=!1;o.each(n,function(t,o){if(i[e]==o[e])return s=!0,!1}),s||r.push(i)}),this.targetData(r.concat(n))},i.vsMemberSelector.ViewModel.prototype.moveAll=function(){var e=this.options.memberIdKey,t=this.sourceData(),i=this.targetData();this.sourceData([]);var n=[];o.each(t,function(t,s){var a=!1;o.each(i,function(t,o){if(s[e]==o[e])return a=!0,!1}),a||n.push(s)}),this.targetData(n.concat(i))},i.vsMemberSelector.ViewModel.prototype.remove=function(){var e=this.options.memberIdKey,t=this.selectTarget(),i=this.sourceData(),n=this.targetData(),s=o.grep(n,function(o,i){for(var n=0;n<t.length;n++)if(o[e]==t[n])return!1;return!0});this.targetData(s);var a=o.grep(n,function(o,i){for(var n=0;n<t.length;n++)if(o[e]==t[n])return!1;return!0},!0),r=[];o.each(a,function(t,n){var s=!1;o.each(i,function(t,o){if(n[e]==o[e])return s=!0,!1}),s||r.push(n)}),this.sourceData(r.concat(i))},i.vsMemberSelector.ViewModel.prototype.removeAll=function(){var e=this.options.memberIdKey,t=this.sourceData(),i=this.targetData();this.targetData([]);var n=[];o.each(i,function(i,s){var a=!1;o.each(t,function(t,o){if(s[e]==o[e])return a=!0,!1}),a||n.push(s)}),this.sourceData(n.concat(t))},i.vsMemberSelector.ViewModel.prototype.reload=function(e){e&&(this.options.memberIdValues=[],this.options=o.extend(!0,{},r,this.options,e)),this.searchValue(""),this.rawTargetData([]),this.targetData([]),this.selectSource([]),this.selectTarget([]),s.call(this),a.call(this)},i.bindingHandlers.vsMemberSelector={init:function(e,n,s,a,r){var l=n();for(l.el=e;e.firstChild;)i.removeNode(e.firstChild);var c=s.get("memberSelectorTemplate"),d=e.appendChild(t.createElement("DIV"));return i.renderTemplate(c,l,{},d,"replaceNode"),l.vsWin=function(){var e=o(this.el),t=o.extend(!0,{},{onOpen:function(){e.show()},onClose:function(){e.hide()}},this.options.vsWin_setting),n=new i.vsWin.ViewModel(t);return n.el=this.el,e.hide(),n}.call(l),{controlsDescendantBindings:!0}},update:function(e,t,o,i,n){}}}(window,document,jQuery,ko),function(e,t,o,i,n){function s(e){var t=this,n={success:!1,message:"数据加载失败",list:[],total:0},s=t.options.ztree_setting.data.simpleData.idKey,a=t.options.teamIdKey,r=t.options.memberNameKey,l={};l[a]=e[s],l[r]=t.searchValue(),null!=t.options.loaderSourceFn&&(l=t.options.loaderSourceFn(l,e)),o.ajax({url:t.options.memberUrl,type:"post",contentType:"application/json",data:i.toJSON(l),dataType:"json",complete:function(){if(t.rawSourceData.removeAll(),t.sourceData.removeAll(),0==n.success)alert(n.message);else if(null!=n.list)for(var e=0;e<n.list.length;e++)t.rawSourceData.push(n.list[e]),t.sourceData.push(n.list[e])},success:function(e){n=e}})}function a(){var e=this,t={success:!1,message:"数据加载失败",list:[],total:0},n=e.options.memberIdValues;if(0!=n.length){var s=e.options.memberIdKey,a=e.rawTargetData();if(n.length==a.length){var r=!0;for(var l in a)if(o.inArray(a[l][s],n)<0){r=!1;break}if(r)return}var c={};c[s]=[];for(var d in n)c[s].push(n[d]);null!=e.options.loaderTargetFn&&(c=e.options.loaderTargetFn(c)),o.ajax({url:e.options.memberUrl,type:"post",contentType:"application/json",data:i.toJSON(c),dataType:"json",complete:function(){if(e.rawTargetData.removeAll(),e.targetData.removeAll(),0==t.success)alert(t.message);else if(null!=t.list)for(var o=0;o<t.list.length;o++)e.rawTargetData.push(t.list[o]),e.targetData.push(t.list[o])},success:function(e){t=e}})}}var r={memberUrl:"",teamIdKey:"fkOrgId",memberIdKey:"id",memberIdValues:[],memberNameKey:"name",selectKey:"name",loaderSourceFn:null,loaderTargetFn:null,renderFn:null,confirmFn:null,joinChar:",",data:null,ztree_setting:{async:{url:"",enable:!0,type:"post",contentType:"application/json",dataType:"json",cache:!1},data:{key:{name:"name"},simpleData:{enable:!0,idKey:"id",pIdKey:"parentId",rootPId:"0"}}},vsWin_setting:{persist:!0}};i.vsTeamMemberSelector={ViewModel:function(e){var t=this;t.options=o.extend(!0,{},r,e),t.ztree=null,t.vsWin=null,t.searchValue=i.observable(""),t.rawSourceData=i.observableArray([]),t.rawTargetData=i.observableArray([]),t.sourceData=i.observableArray([]),t.targetData=i.observableArray([]),t.searchTreeValue=i.observable(""),t.isSelected=ko.observable(!1),t.selectSource=i.observableArray([]),t.selectTarget=i.observableArray([]),t.searchValue.subscribe(function(e){var o=null;if(t.ztree){var i=t.ztree.getSelectedNodes();i.length>0&&(o=i[0])}null!=o&&s.call(t,o)}),t.searchTreeValue.subscribe(function(e){t.ztree.cancelSelectedNode(),null==e||""==e?(t.ztree.cancelSelectedNode(),t.ztree.expandAll(!1)):t.ztree.getNodesByFilter(function(o){o.isParent||-1==o.name.indexOf(e)||t.ztree.selectNode(o,!0,!1)}),t.isSelected(!0)}),t.getSelectDataStr=i.computed(function(){return t.getSelectData(t.options.selectKey)},t),a.call(t),t.isLoadingTree=i.observable(!1)}},i.vsTeamMemberSelector.ViewModel.prototype.show=function(){if(this.ztree){0==this.ztree.getNodes().length&&this.ztree.reAsyncChildNodes(null,"refresh")}else this.ztree=function(){var e=this,t=o.extend(!0,{},{callback:{onClick:function(t,o,i,n){s.call(e,i)},beforeAsync:function(t,o){return 1!=e.isLoadingTree()&&(e.isLoadingTree(!0),!0)},onAsyncSuccess:function(t,o,i,n){e.isLoadingTree(!1)},onAsyncError:function(t,o,i,n,s,a){e.isLoadingTree(!1),alert("数据加载失败!")}}},e.options.ztree_setting);return null==e.options.data?o.fn.zTree.init(o("#"+e.treeId),t):o.fn.zTree.init(o("#"+e.treeId),t,e.options.data)}.call(this);var e=this.rawTargetData();this.targetData(e),this.sourceData([]),this.vsWin?this.vsWin.open():o(this.el).show()},i.vsTeamMemberSelector.ViewModel.prototype.close=function(){this.vsWin?this.vsWin.close():o(this.el).hide()},i.vsTeamMemberSelector.ViewModel.prototype.confirm=function(){this.vsWin?this.vsWin.close():o(this.el).hide();var e=this.targetData();this.rawTargetData(e),this.options.confirmFn&&this.options.confirmFn()},i.vsTeamMemberSelector.ViewModel.prototype.render=function(e){return null==this.options.renderFn?e[this.options.selectKey]:this.options.renderFn(e)},i.vsTeamMemberSelector.ViewModel.prototype.getSelectData=function(e,t){var o=this.rawTargetData();if("string"==typeof e&&void 0!=o){var i=[];for(var n in o)i.push(o[n][e]);return"array"==t?i:(void 0==t&&(t=this.options.joinChar),i.join(t))}return o},i.vsTeamMemberSelector.ViewModel.prototype.move=function(){var e=this.options.memberIdKey,t=this.selectSource(),i=this.sourceData(),n=this.targetData(),s=o.grep(i,function(o,i){for(var n=0;n<t.length;n++)if(o[e]==t[n])return!1;return!0});this.sourceData(s);var a=o.grep(i,function(o,i){for(var n=0;n<t.length;n++)if(o[e]==t[n])return!1;return!0},!0),r=[];o.each(a,function(t,i){var s=!1;o.each(n,function(t,o){if(i[e]==o[e])return s=!0,!1}),s||r.push(i)}),this.targetData(r.concat(n))},i.vsTeamMemberSelector.ViewModel.prototype.moveAll=function(){var e=this.options.memberIdKey,t=this.sourceData(),i=this.targetData();this.sourceData([]);var n=[];o.each(t,function(t,s){var a=!1;o.each(i,function(t,o){if(s[e]==o[e])return a=!0,!1}),a||n.push(s)}),this.targetData(n.concat(i))},i.vsTeamMemberSelector.ViewModel.prototype.remove=function(){var e=this.options.memberIdKey,t=this.selectTarget(),i=this.sourceData(),n=this.targetData(),s=o.grep(n,function(o,i){for(var n=0;n<t.length;n++)if(o[e]==t[n])return!1;return!0});this.targetData(s);var a=o.grep(n,function(o,i){for(var n=0;n<t.length;n++)if(o[e]==t[n])return!1;return!0},!0),r=[];o.each(a,function(t,n){var s=!1;o.each(i,function(t,o){if(n[e]==o[e])return s=!0,!1}),s||r.push(n)}),this.sourceData(r.concat(i))},i.vsTeamMemberSelector.ViewModel.prototype.removeAll=function(){var e=this.options.memberIdKey,t=this.sourceData(),i=this.targetData();this.targetData([]);var n=[];o.each(i,function(i,s){var a=!1;o.each(t,function(t,o){if(s[e]==o[e])return a=!0,!1}),a||n.push(s)}),this.sourceData(n.concat(t))},i.vsTeamMemberSelector.ViewModel.prototype.reload=function(e,t){e&&(this.options.memberIdValues=[],this.options=o.extend(!0,{},r,this.options,e)),this.searchValue(""),this.rawSourceData([]),this.rawTargetData([]),this.sourceData([]),this.targetData([]),this.selectSource([]),this.selectTarget([]),a.call(this),this.ztree&&void 0!=t&&1==t&&this.ztree.reAsyncChildNodes(null,"refresh")},i.bindingHandlers.vsTeamMemberSelector={init:function(e,n,s,a,r){var l=n();for(l.el=e,l.treeId=e.id+"_tree";e.firstChild;)i.removeNode(e.firstChild);var c=s.get("teamMemberSelectorTemplate"),d=e.appendChild(t.createElement("DIV"));return i.renderTemplate(c,l,{},d,"replaceNode"),l.vsWin=function(){var e=o(this.el),t=o.extend(!0,{},{onOpen:function(){e.show()},onClose:function(){e.hide()}},this.options.vsWin_setting),n=new i.vsWin.ViewModel(t);return n.el=this.el,e.hide(),n}.call(l),{controlsDescendantBindings:!0}},update:function(e,t,o,i,n){}}}(window,document,jQuery,ko),function(e,t,o,i,n){function s(e){var t=this,n={success:!1,message:"数据加载失败",list:[],total:0},s=t.options.ztree_setting.data.simpleData.idKey,a=t.options.teamIdKey,r=t.options.memberNameKey,l={};l[a]=e[s],l[r]=t.searchValue(),null!=t.options.loaderSourceFn&&(l=t.options.loaderSourceFn(l)),o.ajax({url:t.options.memberUrl,type:"post",contentType:"application/json",data:i.toJSON(l),dataType:"json",complete:function(){if(t.sourceData.removeAll(),0==n.success)alert(n.message);else if(null!=n.list)for(var e=0;e<n.list.length;e++)t.sourceData.push(n.list[e])},success:function(e){n=e}})}function a(){var e=this,t={success:!1,message:"数据加载失败",list:[],total:0},n=e.options.memberIdValue;if(""!=n){var s={};s[e.options.memberIdKey]=[n],null!=e.options.loaderTargetFn&&(s=e.options.loaderTargetFn(s)),o.ajax({url:e.options.memberUrl,type:"post",contentType:"application/json",data:i.toJSON(s),dataType:"json",complete:function(){e.selectData(null),0==t.success?alert(t.message):null!=t.list&&t.list.length>0&&e.selectData(t.list[0])},success:function(e){t=e}})}}var r={memberUrl:"",teamIdKey:"fkOrgId",memberIdKey:"id",memberIdValue:"",memberNameKey:"name",selectKey:"name",loaderSourceFn:null,loaderTargetFn:null,renderFn:null,confirmFn:null,data:null,ztree_setting:{async:{url:"",enable:!0,type:"post",contentType:"application/json",dataType:"json",cache:!1},data:{key:{name:"name"},simpleData:{enable:!0,idKey:"id",pIdKey:"parentId",rootPId:"0"}}},vsWin_setting:{persist:!0}};i.vsTeamMemberOneSelector={ViewModel:function(e){var t=this;t.options=o.extend(!0,{},r,e),t.ztree=null,t.vsWin=null,t.searchValue=i.observable(""),t.sourceData=i.observableArray([]),t.selectSource=i.observableArray([]),t.selectData=i.observable(null),t.searchValue.subscribe(function(e){var o=null;if(t.ztree){var i=t.ztree.getSelectedNodes();i.length>0&&(o=i[0])}null!=o&&s.call(t,o)}),t.getSelectDataStr=i.computed(function(){return t.getSelectData(t.options.selectKey)},t),a.call(t),t.isLoadingTree=i.observable(!1),t.setOptionTitle=function(e,t){e.title=t.name,ko.applyBindingsToNode(e,t)}}},i.vsTeamMemberOneSelector.ViewModel.prototype.show=function(){if(this.ztree){0==this.ztree.getNodes().length&&this.ztree.reAsyncChildNodes(null,"refresh")}else this.ztree=function(){var e=this,t=o.extend(!0,{},{callback:{onClick:function(t,o,i,n){s.call(e,i)},beforeAsync:function(t,o){return 1!=e.isLoadingTree()&&(e.isLoadingTree(!0),!0)},onAsyncSuccess:function(t,o,i,n){e.isLoadingTree(!1)},onAsyncError:function(t,o,i,n,s,a){e.isLoadingTree(!1),alert("数据加载失败!")}}},e.options.ztree_setting);return null==e.options.data?o.fn.zTree.init(o("#"+e.treeId),t):o.fn.zTree.init(o("#"+e.treeId),t,e.options.data)}.call(this);var e=[],t=this.selectData();null!=t&&e.push(t),this.sourceData(e),this.vsWin?this.vsWin.open():o(this.el).show()},i.vsTeamMemberOneSelector.ViewModel.prototype.close=function(){this.vsWin?this.vsWin.close():o(this.el).hide()},i.vsTeamMemberOneSelector.ViewModel.prototype.confirm=function(){var e=this;e.vsWin?e.vsWin.close():o(e.el).hide();var t=e.options.memberIdKey,i=e.selectSource();if(i.length>0){var n=e.sourceData();o.each(n,function(o,n){if(n[t]==i[0])return e.selectData(n),!1})}e.options.confirmFn&&e.options.confirmFn()},i.vsTeamMemberOneSelector.ViewModel.prototype.render=function(e){return null==this.options.renderFn?e[this.options.selectKey]:this.options.renderFn(e)},i.vsTeamMemberOneSelector.ViewModel.prototype.clear=function(){this.vsWin?this.vsWin.close():o(this.el).hide(),this.selectData(null)},i.vsTeamMemberOneSelector.ViewModel.prototype.getSelectData=function(e){var t=this.selectData();return"string"==typeof e?null==t?"":t[e]:t},i.vsTeamMemberOneSelector.ViewModel.prototype.reload=function(e,t){e&&(this.options.memberIdValue="",this.options=o.extend(!0,{},r,this.options,e)),this.searchValue(""),this.sourceData([]),this.selectSource([]),a.call(this),this.ztree&&void 0!=t&&1==t&&this.ztree.reAsyncChildNodes(null,"refresh")},i.bindingHandlers.vsTeamMemberOneSelector={init:function(e,n,s,a,r){var l=n();for(l.el=e,l.treeId=e.id+"_tree";e.firstChild;)i.removeNode(e.firstChild);var c=s.get("teamMemberOneSelectorTemplate"),d=e.appendChild(t.createElement("DIV"));return i.renderTemplate(c,l,{},d,"replaceNode"),l.vsWin=function(){var e=o(this.el),t=o.extend(!0,{},{onOpen:function(){e.show()},onClose:function(){e.hide()}},this.options.vsWin_setting),n=new i.vsWin.ViewModel(t);return n.el=this.el,e.hide(),n}.call(l),{controlsDescendantBindings:!0}},update:function(e,t,o,i,n){}}}(window,document,jQuery,ko);